<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MSN-AI - Windows Live Messenger with AI</title>
    <link rel="icon" type="image/png" href="assets/general/logo.png" />
    <link rel="stylesheet" href="styles.css" />

</head>

<body>
    <div class="main">
        <!-- Panel de chats (izquierdo) -->
        <div class="mainwindow" id="chats-panel">
            <div class="header">
                <div class="titlebar">
                    <img src="assets/general/live_logo.png" alt="Windows Live Logo">
                    <img id="title" src="assets/general/title_text.png">
                </div>
                <div class="ai-info">
                    <div class="ai-avatar-container">
                        <img id="ai-avatar" src="assets/images/profile.jpeg" alt="AI Avatar">
                        <img id="ai-avatar-frame" src="assets/background/frame_48.png">
                    </div>
                    <div class="ai-profile">
                        <button class="aerobutton" id="ai-status-btn">
                            <h3>MSN-AI Asistente de IA</h3>
                            <div style="display: flex; align-items: center; gap: 4px; width: 100%;">
                                <img id="status-icon" src="assets/status/online.png" alt="Estado" style="width: 16px; height: 16px;">
                                <p id="ai-connection-status" style="margin: 0; font-size: 8pt; color: #b9dde7;">(Online)</p>
                                <img class="arrowdown arrowchats" src="assets/general/small_arrow_lightblue.svg" style="margin-left: auto;">
                            </div>
                        </button>
                        <!-- Menú desplegable de estados -->
                        <div id="status-menu" class="emoticon-picker" style="display:none; position:absolute; top:100%; left:0; z-index:1001; background:white; border:1px solid #ccc; padding:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2);">
                            <div class="status-option" data-status="online" style="display:flex; align-items:center; gap:4px; cursor:pointer; padding:4px;">
                                <img src="assets/status/online.png" alt="Online" style="width:16px; height:16px;">
                                <span>Online</span>
                            </div>
                            <div class="status-option" data-status="away" style="display:flex; align-items:center; gap:4px; cursor:pointer; padding:4px;">
                                <img src="assets/status/away.png" alt="Away" style="width:16px; height:16px;">
                                <span>Away</span>
                            </div>
                            <div class="status-option" data-status="busy" style="display:flex; align-items:center; gap:4px; cursor:pointer; padding:4px;">
                                <img src="assets/status/busy.png" alt="Busy" style="width:16px; height:16px;">
                                <span>Busy</span>
                            </div>
                            <div class="status-option" data-status="invisible" style="display:flex; align-items:center; gap:4px; cursor:pointer; padding:4px;">
                                <img src="assets/status/invisible.png" alt="Invisible" style="width:16px; height:16px;">
                                <span>Invisible</span>
                            </div>
                        </div>
                        <button class="aerobutton" id="model-selector">
                            <p style="margin: 0;" id="current-model">Detectando modelo...</p>
                            <img class="arrowdown arrowchats" src="assets/general/small_arrow_lightblue.svg">
                        </button>
                    </div>
                </div>
            </div>

            <div id="chats-nav">
                <ul class="iconbar" id="left">
                    <button class="aerobutton chataction" id="new-chat-btn" title="Nuevo Chat" style="background:url(assets/contacts-window/1131.png) no-repeat center;"></button>
                    <button class="aerobutton chataction" id="import-btn" title="Importar Todos los Chats" style="background:url(assets/contacts-window/978.png) no-repeat center;"></button>
                    <button class="aerobutton chataction" id="export-btn" title="Exportar Todos los Chats" style="background:url(assets/contacts-window/1484.png) no-repeat center;"></button>
                </ul>
                <ul class="iconbar" id="right">
                    <button class="aerobutton chataction smallarrowbtn" id="settings-btn" title="Configuración del modelo IA">
                        <img src="assets/contacts-window/1489.png" style="height: 16px;">
                        <img class="arrowdown" src="assets/general/small_arrow.svg">
                    </button>
                    <button class="aerobutton chataction" id="order-history-btn" title="Ordenar Historial" style="background:url(assets/contacts-window/1132.png) no-repeat center;"></button>
                </ul>
            </div>

            <div class="chat-search">
                <input id="chat-search-input" type="text" placeholder="Buscar en chats...">
                <button class="searchbar-btn aerobutton" id="export-selected-chats-btn" title="Exportar Chats Seleccionados" style="background:url(assets/contacts-window/1480.png) no-repeat center;"></button>
                <button class="searchbar-btn aerobutton" id="clear-search-btn" title="Limpiar Búsqueda" style="background:url(assets/contacts-window/329.png) no-repeat center;"></button>
            </div>

            <ul class="chat-list" id="chat-list">
                <!-- Los chats se cargarán dinámicamente -->
            </ul>

            <div id="chats-footer">
                <span style="color: #9bb3d4; font-size: 7pt;">MSN-AI v1.0</span>
                <div>
                    <span class="connection-status" id="connection-indicator"></span>
                    <span style="font-size: 7pt;" id="connection-text">Desconectado</span>
                </div>
            </div>
        </div>

        <!-- Panel de chat (derecho) -->
        <div class="mainwindow" id="chat-panel">
            <div class="header">
                <div id="chat-info">
                    <img id="chat-icon" src="assets/chat-window/61.ico">
                    <div id="chat-text">
                        <span id="chat-contact-name">Selecciona un chat</span>
                        <span id="chat-status-message">Bienvenido a MSN-AI</span>
                    </div>
                </div>
                <div id="chat-navbars">
                    <ul class="chatnav" id="left">
                        <button class="aerobutton chat-nav-action" id="decrease-font-size-btn" title="Disminuir tamaño del texto" style="background:url(assets/chat-window/1402.png) no-repeat center;"></button>
                        <button class="aerobutton chat-nav-action" id="increase-font-size-btn" title="Aumentar tamaño del texto" style="background:url(assets/chat-window/1401.png) no-repeat center;"></button>
                        <button class="aerobutton chat-nav-action" id="upload-text-file-btn" title="Subir archivo de texto" style="background:url(assets/chat-window/1403.png) no-repeat center;"></button>
                        <button class="aerobutton chat-nav-action" id="export-current-chat-btn" title="Exportar chat actual" style="background:url(assets/chat-window/1404.png) no-repeat center;"></button>
                        <button class="aerobutton chat-nav-action" id="print-current-chat-btn" title="Imprimir chat actual" style="background:url(assets/chat-window/1405.png) no-repeat center;"></button>
                        <button class="aerobutton chat-nav-action" id="search-current-chat-btn" title="Buscar en el chat actual" style="background:url(assets/chat-window/1406.png) no-repeat center;"></button>
                        <button class="aerobutton chat-nav-action" id="close-current-chat-btn" title="Cerrar chat" style="background:url(assets/chat-window/326.png) no-repeat center;"></button>
                    </ul>
                    <ul class="chatnav" id="right">
                        <button class="aerobutton chat-nav-action smallarrowbtn" id="info-btn" title="Información">
                            <img src="assets/chat-window/1489.png" style="height: 16px;">
                            <img class="arrowdown" src="assets/general/small_arrow_black.svg">
                        </button>
                        <button class="aerobutton chat-nav-action" id="clear-current-chat-btn" title="Limpiar chat" style="background:url(assets/chat-window/329.png) no-repeat center;"></button>
                    </ul>
                </div>
            </div>

            <div class="conversation">
                <div id="messages-container">
                    <div id="messages-display">
                        <div id="ai-thinking">
                            <img src="assets/chat-window/1539.png" alt="">
                            <p class="thinking-dots">La IA está pensando<span id="dots">...</span></p>
                        </div>
                        <div id="messages-area">
                            <div class="message">
                                <span style="color: #666; font-size: 7pt; font-style: italic;">
                                    Bienvenido a MSN-AI - Tu asistente de IA con la nostalgia de Windows Live Messenger<br>
                                    Selecciona un chat existente o crea uno nuevo para comenzar.
                                </span>
                            </div>
                        </div>
                    </div>

                    <div id="handle"></div>

                    <div id="send-area">
                        <ul id="emoticos-selection">
                            <button class="aerobutton textoption smallarrowbtn" id="emoticon-natural-btn" title="Naturales">
                                <img src="assets/chat-window/412.png">
                                <img class="arrowdown" src="assets/general/small_arrow_black.svg">
                            </button>
                            <button class="aerobutton textoption smallarrowbtn" id="emoticon-amor-btn" title="Amor">
                                <img src="assets/chat-window/1487.png">
                                <img class="arrowdown" src="assets/general/small_arrow_black.svg">
                            </button>
                            <button class="aerobutton textoption noarrow" id="enviar-sumbido-btn" title="Sumbido" style="background: url(assets/chat-window/414.png) no-repeat center;"></button>
                            <button class="aerobutton textoption noarrow" id="texto-por-voz-btn" title="Dictado" style="background: url(assets/chat-window/992.png) no-repeat center;"></button>
                            <button class="textoption" style="background: url(assets/chat-window/20204.png) no-repeat center; border: none;"></button>
                            <button class="aerobutton textoption noarrow" id="editor-texto-btn" title="Editor de Texto" style="background: url(assets/chat-window/411.png) no-repeat center;"></button>
                        </ul>

                        <textarea id="message-input" placeholder="Escribe tu mensaje aquí..." disabled></textarea>

                        <div id="bottom-controls">
                            <button class="editortab selected">
                                <img src="assets/chat-window/963.png">
                            </button>
                            <button class="editortab unselected">
                                <img src="assets/chat-window/961.png">
                            </button>
                            <div></div>
                                <button id="send-button" disabled>Enviar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modales -->

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Configuración del Modelo de IA</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div style="padding: 10px 0;">
                <!-- ========== SONIDOS ========== -->
                <div style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="sounds-enabled" checked style="margin-right: 8px;">
                        <span>Activar sonidos</span>
                    </label>
                </div>

                <!-- ========== NOTIFICACIONES DE ESTADO ========== -->
                <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 4px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="notify-status-changes" checked style="margin-right: 8px;">
                        <span>Notificar cambios de estado a la IA</span>
                    </label>
                    <p style="margin: 8px 0 0 24px; font-size: 7pt; color: #666; line-height: 1.4;">
                        Cuando cambies tu estado (Online, Away, Busy, Invisible), la IA será notificada automáticamente en el chat activo.
                    </p>
                </div>

                <!-- ========== SERVIDOR OLLAMA ========== -->
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 6px; font-weight: bold;">
                        Servidor Ollama:
                    </label>
                    <input
                        type="text"
                        id="ollama-server"
                        placeholder="http://localhost:11434"
                        style="width: 100%; padding: 6px 8px; font-size: 8pt; border: thin solid #c7c7c7; box-sizing: border-box; font-family: Tahoma;">
                    <p style="margin: 4px 0 0 0; font-size: 7pt; color: #666;">
                        Dirección del servidor Ollama. Déjalo vacío para autodetección.
                    </p>
                </div>

                <!-- ========== MODELO DE IA ========== -->
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 6px; font-weight: bold;">
                        Modelo de IA:
                    </label>
                    <select
                        id="model-select"
                        style="width: 100%; padding: 6px 8px; font-size: 8pt; border: thin solid #c7c7c7; font-family: Tahoma;">
                        <option value="">Cargando modelos...</option>
                    </select>
                    <p style="margin: 4px 0 0 0; font-size: 7pt; color: #666;">
                        Modelo que se usará para nuevos chats. Los chats existentes mantienen su modelo.
                    </p>
                </div>

                <!-- ========== BOTONES ========== -->
                <div style="text-align: right; margin-top: 20px; padding-top: 15px; border-top: 1px solid #e0e0e0;">
                    <button class="aerobutton" id="test-connection" style="margin-right: 8px; padding: 6px 12px;">
                        🔌 Probar Conexión
                    </button>
                    <button class="aerobutton" id="save-settings" style="padding: 6px 12px; font-weight: bold;">
                        💾 Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="export-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Exportar Chats</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div>
                <p>Exporta todos tus chats en formato JSON para respaldar o migrar.</p>
                <button class="aerobutton" id="download-chats">Descargar Chats</button>
            </div>
        </div>
    </div>

    <div id="import-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Importar Chats</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div>
                <p>Selecciona un archivo JSON de chats exportado previamente.</p>
                <input type="file" id="import-file" accept=".json">
                <br><br>
                <button class="aerobutton" id="import-chats-btn">Importar</button>
            </div>
        </div>
    </div>

    <!-- Audio elements para sonidos -->
    <audio id="sound-login" preload="auto">
        <source src="assets/sounds/login.wav" type="audio/wav">
    </audio>
    <audio id="sound-message-in" preload="auto">
        <source src="assets/sounds/message_in.wav" type="audio/wav">
    </audio>
    <audio id="sound-message-out" preload="auto">
        <source src="assets/sounds/message_out.wav" type="audio/wav">
    </audio>
    <audio id="sound-nudge" preload="auto">
        <source src="assets/sounds/nudge.wav" type="audio/wav">
    </audio>
    <audio id="sound-calling" preload="auto">
        <source src="assets/sounds/calling.wav" type="audio/wav">
    </audio>
    <!-- PICKERS DE EMOTICONES -->
    <div id="emoticon-natural-picker" class="emoticon-picker" style="display:none;"></div>
    <div id="emoticon-amor-picker" class="emoticon-picker" style="display:none;"></div>

    <!-- INFO MODAL (si no existe ya) -->
    <div id="info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>MSN-AI v1.0</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div class="tab-content" id="contact">
                               <h1>Contacto</h1>
                               <p>
                                   Gracias por tu interés en <strong>MSN-AI</strong>.
                               </p>

                               <div class="contact-info">
                                   <p>
                                       <strong>Nombre:</strong> Alan Mac-Arthur García Díaz
                                   </p>
                                   <p>
                                       <strong>Correo electrónico:</strong>
                                       <a
                                           href="mailto:alan.mac.arthur.garcia.diaz@gmail.com"
                                           >alan.mac.arthur.garcia.diaz@gmail.com</a
                                       >
                                   </p>
                                   <p>
                                       <strong>Proyecto:</strong>
                                       <a
                                           href="https://github.com/mac100185/MSN-AI"
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           >MSN-AI en GitHub</a
                                       >
                                   </p>
                               </div>

                               <p>
                                   Este es un proyecto personal de código abierto. Por
                                   favor, ten paciencia si la respuesta no es inmediata.
                               </p>
                               <p>
                                   Antes de contactar, asegúrate de haber revisado la
                                   documentación y el código fuente en el repositorio de
                                   GitHub.
                               </p>
                           </div>
        </div>
    </div>
    <!-- Picker de formato de texto -->
    <div id="text-format-picker" class="emoticon-picker" style="display:none;">
      <span title="Negrita">N</span>
      <span title="Cursiva">C</span>
      <span title="Subrayado">S</span>
    </div>

    <!-- Modal de búsqueda en chat -->
    <div id="search-chat-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Buscar en el chat</h3>
          <span class="modal-close">&times;</span>
        </div>
        <div style="margin-top: 10px;">
          <input type="text" id="search-term-input" placeholder="Escribe palabra o frase..." style="width:100%; padding:4px; font-size:8pt; border: thin solid #c7c7c7;">
          <div style="margin-top: 10px; text-align: right;">
            <button class="aerobutton" id="do-search-btn">Buscar</button>
            <button class="aerobutton" id="clear-search-highlight">Limpiar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de confirmación para eliminar chat -->
    <div id="delete-chat-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Eliminar chat</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div style="margin-top: 15px;">
                <p>¿Estás seguro de que deseas eliminar este chat? Esta acción no se puede deshacer.</p>
                <div style="text-align: right; margin-top: 15px;">
                    <button class="aerobutton" id="cancel-delete-btn">Cancelar</button>
                    <button class="aerobutton" id="confirm-delete-btn" style="margin-left: 8px;">Eliminar</button>
                </div>
            </div>
        </div>
    </div>


    <script src="msn-ai.js"></script>

</body>
</html>
